---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
posts.sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime());
---

<Layout 
    title="Blog | Naturderma - Nieuws en Tips over Hypoallergene Sieraden" 
    description="Lees de laatste artikelen over hypoallergene sieraden, tips voor gevoelige huid, en nieuws van Naturderma."
>
    <main class="blog-container animate-in">
        <h1>Blog</h1>
        <section class="blog-posts stagger-in">
            {posts.map(post => (
                <article class="blog-post">
                    <a href={`/blog/${post.slug}`}>
                        {post.data.heroImage && (
                            <img 
                                src={post.data.heroImage} 
                                alt={post.data.title}
                                loading="lazy"
                            />
                        )}
                        <div class="content">
                            <h2>{post.data.title}</h2>
                            <p class="excerpt">{post.data.description}</p>
                            <span class="date">
                                {new Date(post.data.pubDate).toLocaleDateString('nl-NL', {
                                    year: 'numeric',
                                    month: 'long',
                                    day: 'numeric'
                                })}
                            </span>
                        </div>
                    </a>
                </article>
            ))}
        </section>
    </main>
</Layout>

<style lang="scss">
    @use 'sass:map';
    @use '../styles/_partials/_design-system' as *;

    .blog-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: map.get($spacing, 8);

        h1 {
            font-size: map.get($font-sizes, 3xl);
            color: var(--text-primary);
            margin-bottom: map.get($spacing, 8);
            text-align: center;
        }
    }

    .blog-posts {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: map.get($spacing, 8);
    }

    .blog-post {
        border-radius: map.get($spacing, 4);
        overflow: hidden;
        background: var(--card-bg);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;

        &:hover {
            transform: translateY(-4px);
        }

        a {
            text-decoration: none;
            color: inherit;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .content {
            padding: map.get($spacing, 6);
            flex: 1;
            display: flex;
            flex-direction: column;

            h2 {
                font-size: map.get($font-sizes, xl);
                color: var(--text-primary);
                margin-bottom: map.get($spacing, 2);
            }

            .excerpt {
                color: var(--text-secondary);
                margin-bottom: map.get($spacing, 4);
                flex: 1;
            }

            .date {
                font-size: map.get($font-sizes, sm);
                color: var(--text-tertiary);
            }
        }
    }

    @media (max-width: map.get($breakpoints, md)) {
        .blog-container {
            padding: map.get($spacing, 4);
        }

        .blog-posts {
            grid-template-columns: 1fr;
        }
    }
</style> 